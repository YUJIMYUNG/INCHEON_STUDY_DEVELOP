# 파일 업로드와 다운로드

## 파일 업로드

> 클라이언트가 서버에게 첨부파일을 보내고 서버가 저장하는 행위
> 

### 목적

- 프로필사진 등록
- 제품사진 등록
- 게시판 첨부파일 등록 등

### 스프링 내장함수 지원

- MultiFile 클래스
    - `getOriginalFilename()` : 첨부파일의 파밍ㄹ명을 반환하는 함수
    - `getName()` : 첨부파일의 속성명을 반환하는 함수
    - `getSize()` : 첨부파일의 용량을 반환하는 함수(byte)
    - `isEmpty()` : 첨부파일의 존재여부를 반환하는 함수
    - `***.transferTo(file객체 경로)` : 지정된 경로에 첨부파일을 업로드한다.

### 업로드 과정

**클라이언트(유저/크롬/JS)**  ——> **HTTP 업로드**  ——> **Controller** ———> **service** ———> **서버내폴더**

<aside>
💡

서버란?
자료를 제공하는 PC, Spring(톰캣 내장 서버)

(코드가 실행/배포 되기 전)
개발자 코드 파일 경로 : 프로젝트명 → src → main → java
(코드가 실행/배포 된)
서버내 코드 파일 경로 : 프로젝트명 → build → 

* build란 : 소스파일을 실행 가능한 파일로 컴파일 하는 과정
* 소스를 build한다 : 내 코드를 서버에 컴파일한다.(내 코드를 서버에 배포한다.)

🌟🌟🌟**중요**🌟🌟🌟

클라이언트는 개발자의 소스코드를 사용하는게 아니라, 서버에 배포/빌드 된 코드를 실행시킨다.

그렇기때문에 서버가 실행 중인 상태에서 코드를 수정해도 클라이언트에 반영이 안된다. 즉, 코드를 수정하면 서버를 재실행 해야된다.

</aside>

### 업로드 방법

1. 업로드 할 경로를 지정한다. 주로 src가 아닌 build(서버)에 업로드한다.
2. 프로젝트폴더명 -> build -> resources -> main -> static -> img폴더 -> 'copy path' -> absolute path 으로 경로 복사
3. 마지막 경로 뒤에 / 추가해야함 (수업때 \\를 추가하라고 하셨는데 오류났음. 맥은 경로 뒤에 / )

### 고려할 사항

1. 서로 다른 사람이 파일명을 동일하게 업로드 했을 때 식별 불가능(식별 충돌)
    
    → 방안 1) 식별자 추가를 추가한다. (파일명 앞에 날짜/시간을 붙임)
    → 방안 2) UUID(소프트웨어에서 사용하는 식별자 표준 규약) 라이브러리 사용하여 조합한다.
    → 방안 3) DB 테이블의 PK번호 조합 등
    

## 파일 다운로드

> 서버가 클라이언트에게 첨부파일을 보내는 행위
> 

### 목적

- 첨부파일 내려받기
- 첨부파일 다운로드 등

### 스프링 내장함수 지원